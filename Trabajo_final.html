<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>Making your first Phaser 3 Game - Part 7</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

    var config = {
        type: Phaser.WEBGL,
        width: 2400,
        height: 800,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 350 },
                debug: false
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var player;
    var platforms;
    var cube;
    var tower;
    var cursors;
    var hongo;
    var healthBar;
    var hurtBar;
    var Life;
    var score = 0
    var scoreText;

    var game = new Phaser.Game(config);
    


    function preload ()
    {
        this.load.image('fondo', 'images/Fondo.png');
        this.load.image("torre", "images/Rock Tower.png")
        this.load.image('piso', 'images/platform.png');
        this.load.image("cubo", "images/Rock.png");
        this.load.image("disparo", "images/disparo.png")
        this.load.image("barraVida", "images/Barra vida.png")
        this.load.image("barraDaño", "images/Barra daño.png")
        this.load.spritesheet("hongo", "images/Hongo Alien.png", {frameWidth: 34, frameHeight: 39});
        this.load.spritesheet('jugador', 'images/Jugador.png', { frameWidth: 33, frameHeight: 38 });
        
    }

    function create ()
    {
        this.add.image(1200, 400, 'fondo')
        this.add.image(2400, 400, "fondo")
        this.add.image(3600, 400, "fondo")

        platforms = this.physics.add.staticGroup();
        cube = this.physics.add.staticGroup();
        tower = this.physics.add.staticGroup();

        platforms.create(400, 750, 'piso');
        platforms.create(600, 750, 'piso');
        platforms.create(600, 425, 'piso');
        platforms.create(200, 750, 'piso');
        cube.create(1000, 600, "cubo");
        platforms.create(1000, 250, 'piso');
        cube.create(800, 650, "cubo");
        cube.create(850, 475, "cubo");
        cube.create(860, 325, "cubo");
        platforms.create(1400, 335, 'piso');
        platforms.create(2700, 320, 'piso');
        tower.create(1150, 600, "torre");
        tower.create(1150, 550, "torre");
        platforms.create(1270, 500, 'piso');
        tower.create(1500, 250, "torre");
        tower.create(1500, 325, "torre");
        platforms.create(1270, 750, 'piso');
        platforms.create(1370, 750, 'piso');
        platforms.create(1570, 750, 'piso');
        cube.create(1700, 650, "cubo");
        cube.create(1540, 555, "cubo");
        cube.create(1530, 435, "cubo");
        cube.create(1520, 335, "cubo");
        tower.create(1875, 750, "torre");
        tower.create(1875, 520, "torre");
        platforms.create(1995, 635, 'piso');
        platforms.create(2250, 635, 'piso');
        platforms.create(2505, 635, 'piso');
        tower.create(2600, 750, "torre");
        tower.create(2600, 550, "torre");
        tower.create(2800, 750, "torre");
        tower.create(2800, 550, "torre");
        cube.create(2560, 535, 'cubo');
        cube.create(2570, 425, 'cubo');
        platforms.create(2900, 320, 'piso');
        platforms.create(3100, 320, 'piso');
        platforms.create(3300, 320, 'piso');
        platforms.create(3500, 320, 'piso');
        tower.create(3800, 150, "torre");
        tower.create(3800, 200, "torre");
        tower.create(3800, 270, "torre");
        platforms.create(3125, 520, 'piso');
        platforms.create(3325, 520, 'piso');
        platforms.create(3525, 520, 'piso');
        platforms.create(3720, 520, 'piso');
        platforms.create(2900, 750, 'piso');
        platforms.create(3100, 750, 'piso');
        platforms.create(3300, 750, 'piso');
        platforms.create(3500, 750, 'piso');
        platforms.create(3900, 750, 'piso');
        platforms.create(4100, 750, 'piso');
        platforms.create(4300, 750, 'piso');

        
        hongo = this.physics.add.sprite(150, 710, "hongo");

        
        player.setCollideWorldBounds(false);
        

        this.anims.create({
            key: 'left',
            frames: this.anims.generateFrameNumbers('jugador', { start: 0, end: 3 }),
            frameRate: 10,
            repeat: -1
        });

        this.anims.create({
            key: 'turn',
            frames: [ { key: 'jugador', frame: 4 } ],
            frameRate: 20
        });

        this.anims.create({
            key: 'right',
            frames: this.anims.generateFrameNumbers('jugador', { start: 5, end: 8 }),
            frameRate: 10,
            repeat: -1
        });

        cursors = this.input.keyboard.createCursorKeys();

        this.physics.add.collider(player, platforms);
        this.physics.add.collider(player, cube);
        this.physics.add.collider(player, tower);
        this.physics.add.collider(hongo, platforms);
        this.physics.add.collider(hongo, cube);
        this.physics.add.collider(hongo, tower);



        
        this.cameras.main.setBounds(0,0,4800,800)
        player.health = 100;
        player.maxHealth = 100;
        hurtBar = this.add.image(300, 20, "barraDaño")
        hurtBar.scrollFactorX = 0;
        hurtBar.scrollFactorY = 0;

        healthBar = this.add.image(300,20, "barraVida");
        healthBar.scrollFactorX = 0;
        healthBar.scrollFactorY = 0;
        

        Life = this.add.text(210, 20, "Vida", {fontSize:"20px", fill:"#ffffff"});
        Life.scrollFactorX = 0;
        Life.scrollFactorY = 0;

        scoreText = this.add.text(16, 40, "Score: 0", {fontSize: "32px", fill: "#000"});

    }
    
   

    function update ()
    {
        this.cameras.main.centerOn(player.x,player.y)
        if (cursors.left.isDown)
        {
            player.setVelocityX(-260);

            player.anims.play('left', true);

        }
        else if (cursors.right.isDown)
        {
            player.setVelocityX(260);

            player.anims.play('right', true);

        }
        else
        {
            player.setVelocityX(0);

            player.anims.play('turn');
        }
        if (cursors.up.isDown && player.body.touching.down)
        {
            player.setVelocityY(-300);
        }
       
        
        
        
    }
   

    


</script>

</body>
</html> 